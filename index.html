<main>
  <section class="menu-section">
    <button class="collapsible">Entrantes</button>
    <div class="content"><ul id="Entrantes"></ul></div>
  </section>

  <section class="menu-section">
    <button class="collapsible">Primeros platos</button>
    <div class="content"><ul id="Primeros platos"></ul></div>
  </section>

  <section class="menu-section">
    <button class="collapsible">Segundos platos</button>
    <div class="content"><ul id="Segundos platos"></ul></div>
  </section>

  <section class="menu-section">
    <button class="collapsible">Postres</button>
    <div class="content"><ul id="Postres"></ul></div>
  </section>

  <section class="menu-section">
    <button class="collapsible">Bebidas</button>
    <div class="content"><ul id="Bebidas"></ul></div>
  </section>
</main>

<script type="module">
import { supabase } from './js/supabase.js'

async function cargarCarta() {
  const { data: menu, error } = await supabase.from('Menu').select('*').order('id')
  if (error) return console.error(error)

  const categorias = ["Entrantes","Primeros platos","Segundos platos","Postres","Bebidas"]

  categorias.forEach(cat => {
    const ul = document.getElementById(cat)
    ul.innerHTML = ''
    menu.filter(item => item.categoria === cat)
        .forEach(item => {
          const li = document.createElement('li')
          li.innerHTML = `
            <div style="display:flex; justify-content:space-between;">
              <div>
                <span class="dish">${item.plato}</span>
                ${item.descripcion ? ' – ' + item.descripcion : ''}
              </div>
              ${item.precio ? `<div class="precio">€${item.precio}</div>` : ''}
            </div>
          `
          ul.appendChild(li)
        })
  })
}

// Collapsible
document.querySelectorAll(".collapsible").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".collapsible").forEach(otherBtn => {
      if (otherBtn !== btn) {
        otherBtn.classList.remove("active")
        otherBtn.nextElementSibling.style.display = "none"
      }
    })
    btn.classList.toggle("active")
    const content = btn.nextElementSibling
    content.style.display = content.style.display === "block" ? "none" : "block"
  })
})

cargarCarta()
</script>
